import{u as y,r as a,a as v,j as e,L as g}from"./index-G8dAaOpg.js";import{u as w}from"./usePageStyle-CtML4cOJ.js";const L=()=>{w("/css/login.css");const{login:h,user:r,loading:i}=y(),[c,f]=a.useState(""),[d,p]=a.useState(""),[m,l]=a.useState(""),[o,u]=a.useState(!1),[x,b]=a.useState(!1),t=v();a.useEffect(()=>{if(r&&!i){const s=Array.isArray(r.roles)&&r.roles.length?r.roles:[r.role||"student"];s.includes("admin")?t("/admin/dashboard"):s.includes("nt")?t("/nt/dashboard"):s.includes("teacher")?t("/teachers"):t("/home")}},[r,i,t]),a.useEffect(()=>{document.documentElement.setAttribute("data-theme","light");const s=new URLSearchParams(window.location.search);s.get("signup")==="success"&&b(!0),s.get("error")==="1"&&l("Invalid username or password")},[]);const j=async s=>{s.preventDefault(),u(!0),l("");try{const n=await h(c,d)}catch(n){console.error("Login error:",n),l(n.message||"Invalid login credentials.")}finally{u(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx("img",{src:"/images/background.jpg",alt:"Background",className:"logo"}),e.jsxs("div",{className:"login-card",children:[e.jsxs("div",{className:"login-header",children:[e.jsx("img",{src:"/images/tcc-logo.png",alt:"Talisay City College logo",className:"school-logo"}),e.jsx("h2",{className:"mb-2",children:"Talisay City College"})]}),e.jsxs("form",{id:"loginForm",className:"w-100",onSubmit:j,children:[m&&e.jsx("div",{className:"text-danger mb-3",id:"error-message",style:{display:"block"},children:m}),x&&e.jsx("div",{className:"alert alert-success mb-3",children:"Account created successfully! Please login."}),e.jsxs("div",{className:"form-group mb-3",children:[e.jsx("label",{htmlFor:"username",className:"form-label",children:"Username"}),e.jsx("input",{type:"text",className:"form-control",id:"username",name:"username",placeholder:"Enter your username",required:!0,value:c,onChange:s=>f(s.target.value),disabled:o,autoComplete:"username"})]}),e.jsxs("div",{className:"form-group mb-3",children:[e.jsx("label",{htmlFor:"password",className:"form-label",children:"Password"}),e.jsx("input",{type:"password",className:"form-control",id:"password",name:"password",placeholder:"Enter your password",required:!0,value:d,onChange:s=>p(s.target.value),disabled:o})]}),e.jsx("button",{type:"submit",className:"btn btn-primary w-100 mb-3",disabled:o,children:o?"Logging in...":"Login"}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e.jsx(g,{to:"/forgot-password",style:{fontSize:"14px",color:"var(--color-cliff)",textDecoration:"none"},children:"Forgot Password?"}),e.jsx(g,{to:"/signup",style:{fontSize:"14px",color:"var(--color-cliff)",textDecoration:"none"},children:"Create Account"})]})]})]})]})};export{L as default};
