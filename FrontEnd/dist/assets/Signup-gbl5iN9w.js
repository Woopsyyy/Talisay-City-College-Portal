import{a as F,r as t,j as e,A as b}from"./index-G8dAaOpg.js";import{u as L}from"./usePageStyle-CtML4cOJ.js";const q=()=>{L("/css/signup.css");const w=F(),[s,C]=t.useState({name:"",username:"",email:"",password:""}),[v,I]=t.useState(null),[n,P]=t.useState(null),[c,u]=t.useState({msg:"",ok:null,show:!1}),[d,p]=t.useState({msg:"",ok:null,show:!1}),[f,g]=t.useState({msg:"",ok:null,show:!1}),[h,j]=t.useState({msg:"",ok:null,show:!1}),[k,N]=t.useState(""),[x,S]=t.useState(!1),[y,A]=t.useState(!1);t.useEffect(()=>{s.name?s.name.length<2?g({msg:"Name is too short",ok:!1,show:!0}):g({msg:"Looks good",ok:!0,show:!0}):g({show:!1}),s.username?s.username.length<3?p({msg:"Username too short",ok:!1,show:!0}):p({msg:"Looks good",ok:!0,show:!0}):p({show:!1});const r=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;s.email?r.test(s.email)?u({msg:"Valid email format",ok:!0,show:!0}):u({msg:"Invalid email address",ok:!1,show:!0}):u({show:!1});const a=s.password;if(!a)j({show:!1});else{let l="",o=!0;a.length<6&&(l="Password must be at least 6 characters",o=!1),j({msg:o?"Strong password":l,ok:o,show:!0})}},[s]),t.useEffect(()=>{const r=f.ok===!0,a=d.ok===!0,l=c.ok===!0,o=h.ok===!0;A(r&&a&&l&&o&&!x)},[f,d,c,h,x]);const i=r=>{const{name:a,value:l}=r.target;C(o=>({...o,[a]:l}))},E=r=>{if(r.target.files&&r.target.files[0]){const a=r.target.files[0];I(a);const l=new FileReader;l.onload=o=>P(o.target.result),l.readAsDataURL(a)}},D=async r=>{if(r.preventDefault(),!!y){S(!0),N("");try{if(v){const a=new FormData;a.append("name",s.name),a.append("username",s.username),a.append("password",s.password),a.append("email",s.email),a.append("role","student"),a.append("profile_picture",v),await b.signup(a)}else await b.signup({username:s.username,password:s.password,full_name:s.name,email:s.email,role:"student"});w("/?signup=success")}catch(a){console.error("Signup error:",a),N(a.message||"Signup failed")}finally{S(!1)}}},m=r=>{if(!r.show)return null;let a=r.ok?"bi bi-check-circle-fill text-success":"bi bi-x-circle-fill text-danger",l=r.ok?"text-success":"text-danger";return e.jsxs("div",{className:`field-feedback ${l}`,style:{display:"flex",alignItems:"center",marginTop:"6px",fontSize:"0.9rem"},children:[e.jsx("span",{className:"icon",children:e.jsx("i",{className:a,"aria-hidden":"true"})}),e.jsx("span",{className:"msg",style:{marginLeft:"5px"},children:r.msg})]})};return e.jsxs("div",{className:"main-container",children:[e.jsxs("div",{className:"user-card-preview",id:"userCardPreview",children:[e.jsx("div",{className:`profile-circle ${n?"has-image":""}`,children:e.jsx("div",{className:`profile-image ${n?"visible":""}`,id:"cardImage",style:{backgroundImage:n?`url(${n})`:"none"}})}),e.jsx("h2",{id:"cardName",className:s.name?"visible":"",children:s.name||"Your Name"})]}),e.jsxs("div",{className:"signup-container",children:[e.jsx("h2",{style:{color:"var(--color-ethereal) !important"},children:"Create Your Account"}),k&&e.jsx("div",{className:"alert alert-danger mb-3",children:k}),e.jsxs("form",{id:"signupForm",onSubmit:D,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("input",{type:"text",id:"name",className:"form-control",name:"name",placeholder:"Full Name",required:!0,style:{color:"var(--color-ethereal) !important"},value:s.name,onChange:i}),m(f)]}),e.jsxs("div",{className:"form-group",children:[e.jsx("input",{type:"text",id:"username",className:"form-control",name:"username",placeholder:"Username",required:!0,style:{color:"var(--color-ethereal) !important"},value:s.username,onChange:i}),m(d)]}),e.jsxs("div",{className:"form-group",children:[e.jsx("input",{type:"email",id:"email",className:"form-control",name:"email",placeholder:"Email Address",required:!0,style:{color:"var(--color-ethereal) !important"},value:s.email,onChange:i}),m(c)]}),e.jsxs("div",{className:"form-group",children:[e.jsx("input",{type:"password",id:"password",className:"form-control",name:"password",placeholder:"Password",required:!0,style:{color:"var(--color-ethereal) !important"},value:s.password,onChange:i}),m(h)]}),e.jsxs("div",{className:"file-input-wrapper",children:[e.jsx("label",{htmlFor:"profileImage",className:"file-input-label",children:"Choose Profile Picture"}),e.jsx("input",{type:"file",id:"profileImage",name:"profileImage",accept:"image/*",style:{display:"none"},onChange:E})]}),e.jsx("button",{type:"submit",className:"submit-btn",disabled:!y,children:x?"Creating Account...":"Create Account"})]}),e.jsx("div",{className:"login-link",children:e.jsxs("p",{children:["Already have an account? ",e.jsx("a",{href:"#",onClick:r=>{r.preventDefault(),w("/")},children:"Login here"})]})})]})]})};export{q as default};
